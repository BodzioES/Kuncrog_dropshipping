$(function(){const n=$("#sameAddressCheckbox"),o=$("#shipping-address"),e=()=>{n.prop("checked")?o.hide():o.show()};e(),n.on("change",e),$(document).ready(function(){$('input[name="id_shipping_method"]').on("change",function(){const t=$(this).val();$.ajax({url:"/checkout/update-total",type:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),id_shipping_method:t},success:function(s){$("#shippingCost").text(s.shippingCost+" zł"),$("#totalPrice").text(s.totalPrice+" zł")},error:function(){alert("Błąd podczas aktualizacji ceny dostawy")}})})}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('input[name="shipping_method"]')})});document.addEventListener("DOMContentLoaded",()=>{document.querySelector("#checkout-form").addEventListener("submit",async function(n){n.preventDefault();const o=new FormData(this);try{const t=await(await fetch("/checkout",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"},body:o})).json();t.success?(await Swal.fire({title:"Sukces!",text:t.message,icon:"success",confirmButtonText:'<i class="fas fa-check"></i> OK'}),window.location.href="/"):await Swal.fire("Błąd!",t.message||"Nie udało się zapisać zamówienia","error")}catch(e){console.error(e),await Swal.fire("Błąd!","Wystąpił problem z serwerem","error")}})});
